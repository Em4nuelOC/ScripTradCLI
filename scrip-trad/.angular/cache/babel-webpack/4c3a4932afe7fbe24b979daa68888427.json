{"ast":null,"code":"var _asyncToGenerator = require(\"C:/Users/CND12816RD/Desktop/Sabrina/github/Scriptrad/ScripTradCLI/scrip-trad/node_modules/@babel/runtime/helpers/asyncToGenerator\").default;\n\nvar PDFJS = null;\n\nfunction render_page(pageData) {\n  //check documents https://mozilla.github.io/pdf.js/\n  //ret.text = ret.text ? ret.text : \"\";\n  let render_options = {\n    //replaces all occurrences of whitespace with standard spaces (0x20). The default value is `false`.\n    normalizeWhitespace: false,\n    //do not attempt to combine same line TextItem's. The default value is `false`.\n    disableCombineTextItems: false\n  };\n  return pageData.getTextContent(render_options).then(function (textContent) {\n    let lastY,\n        text = ''; //https://github.com/mozilla/pdf.js/issues/8963\n    //https://github.com/mozilla/pdf.js/issues/2140\n    //https://gist.github.com/hubgit/600ec0c224481e910d2a0f883a7b98e3\n    //https://gist.github.com/hubgit/600ec0c224481e910d2a0f883a7b98e3\n\n    for (let item of textContent.items) {\n      if (lastY == item.transform[5] || !lastY) {\n        text += item.str;\n      } else {\n        text += '\\n' + item.str;\n      }\n\n      lastY = item.transform[5];\n    } //let strings = textContent.items.map(item => item.str);\n    //let text = strings.join(\"\\n\");\n    //text = text.replace(/[ ]+/ig,\" \");\n    //ret.text = `${ret.text} ${text} \\n\\n`;\n\n\n    return text;\n  });\n}\n\nconst DEFAULT_OPTIONS = {\n  pagerender: render_page,\n  max: 0,\n  //check https://mozilla.github.io/pdf.js/getting_started/\n  version: 'v1.10.100'\n};\n\nfunction PDF(_x, _x2) {\n  return _PDF.apply(this, arguments);\n}\n\nfunction _PDF() {\n  _PDF = _asyncToGenerator(function* (dataBuffer, options) {\n    var isDebugMode = false;\n    let ret = {\n      numpages: 0,\n      numrender: 0,\n      info: null,\n      metadata: null,\n      text: \"\",\n      version: null\n    };\n    if (typeof options == 'undefined') options = DEFAULT_OPTIONS;\n    if (typeof options.pagerender != 'function') options.pagerender = DEFAULT_OPTIONS.pagerender;\n    if (typeof options.max != 'number') options.max = DEFAULT_OPTIONS.max;\n    if (typeof options.version != 'string') options.version = DEFAULT_OPTIONS.version;\n    if (options.version == 'default') options.version = DEFAULT_OPTIONS.version;\n    PDFJS = PDFJS ? PDFJS : require(`./pdf.js/${options.version}/build/pdf.js`);\n    ret.version = PDFJS.version; // Disable workers to avoid yet another cross-origin issue (workers need\n    // the URL of the script to be loaded, and dynamically loading a cross-origin\n    // script does not work).\n\n    PDFJS.disableWorker = true;\n    let doc = yield PDFJS.getDocument(dataBuffer);\n    ret.numpages = doc.numPages;\n    let metaData = yield doc.getMetadata().catch(function (err) {\n      return null;\n    });\n    ret.info = metaData ? metaData.info : null;\n    ret.metadata = metaData ? metaData.metadata : null;\n    let counter = options.max <= 0 ? doc.numPages : options.max;\n    counter = counter > doc.numPages ? doc.numPages : counter;\n    ret.text = \"\";\n\n    for (var i = 1; i <= counter; i++) {\n      let pageText = yield doc.getPage(i).then(pageData => options.pagerender(pageData)).catch(err => {\n        // todo log err using debug\n        debugger;\n        return \"\";\n      });\n      ret.text = `${ret.text}\\n\\n${pageText}`;\n    }\n\n    ret.numrender = counter;\n    doc.destroy();\n    return ret;\n  });\n  return _PDF.apply(this, arguments);\n}\n\nmodule.exports = PDF;","map":{"version":3,"sources":["C:/Users/CND12816RD/Desktop/Sabrina/github/Scriptrad/ScripTradCLI/scrip-trad/node_modules/pdf-parse/lib/pdf-parse.js"],"names":["PDFJS","render_page","pageData","render_options","normalizeWhitespace","disableCombineTextItems","getTextContent","then","textContent","lastY","text","item","items","transform","str","DEFAULT_OPTIONS","pagerender","max","version","PDF","dataBuffer","options","isDebugMode","ret","numpages","numrender","info","metadata","require","disableWorker","doc","getDocument","numPages","metaData","getMetadata","catch","err","counter","i","pageText","getPage","destroy","module","exports"],"mappings":"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","sourcesContent":["var PDFJS = null;\n\nfunction render_page(pageData) {\n    //check documents https://mozilla.github.io/pdf.js/\n    //ret.text = ret.text ? ret.text : \"\";\n\n    let render_options = {\n        //replaces all occurrences of whitespace with standard spaces (0x20). The default value is `false`.\n        normalizeWhitespace: false,\n        //do not attempt to combine same line TextItem's. The default value is `false`.\n        disableCombineTextItems: false\n    }\n\n    return pageData.getTextContent(render_options)\n        .then(function(textContent) {\n            let lastY, text = '';\n            //https://github.com/mozilla/pdf.js/issues/8963\n            //https://github.com/mozilla/pdf.js/issues/2140\n            //https://gist.github.com/hubgit/600ec0c224481e910d2a0f883a7b98e3\n            //https://gist.github.com/hubgit/600ec0c224481e910d2a0f883a7b98e3\n            for (let item of textContent.items) {\n                if (lastY == item.transform[5] || !lastY){\n                    text += item.str;\n                }  \n                else{\n                    text += '\\n' + item.str;\n                }    \n                lastY = item.transform[5];\n            }            \n            //let strings = textContent.items.map(item => item.str);\n            //let text = strings.join(\"\\n\");\n            //text = text.replace(/[ ]+/ig,\" \");\n            //ret.text = `${ret.text} ${text} \\n\\n`;\n            return text;\n        });\n}\n\nconst DEFAULT_OPTIONS = {\n    pagerender: render_page,\n    max: 0,\n    //check https://mozilla.github.io/pdf.js/getting_started/\n    version: 'v1.10.100'\n}\n\nasync function PDF(dataBuffer, options) {\n    var isDebugMode = false;\n\n    let ret = {\n        numpages: 0,\n        numrender: 0,\n        info: null,\n        metadata: null,\n        text: \"\",\n        version: null\n    };\n\n    if (typeof options == 'undefined') options = DEFAULT_OPTIONS;\n    if (typeof options.pagerender != 'function') options.pagerender = DEFAULT_OPTIONS.pagerender;\n    if (typeof options.max != 'number') options.max = DEFAULT_OPTIONS.max;\n    if (typeof options.version != 'string') options.version = DEFAULT_OPTIONS.version;\n    if (options.version == 'default') options.version = DEFAULT_OPTIONS.version;\n\n    PDFJS = PDFJS ? PDFJS : require(`./pdf.js/${options.version}/build/pdf.js`);\n\n    ret.version = PDFJS.version;\n\n    // Disable workers to avoid yet another cross-origin issue (workers need\n    // the URL of the script to be loaded, and dynamically loading a cross-origin\n    // script does not work).\n    PDFJS.disableWorker = true;\n    let doc = await PDFJS.getDocument(dataBuffer);\n    ret.numpages = doc.numPages;\n\n    let metaData = await doc.getMetadata().catch(function(err) {\n        return null;\n    });\n\n    ret.info = metaData ? metaData.info : null;\n    ret.metadata = metaData ? metaData.metadata : null;\n\n    let counter = options.max <= 0 ? doc.numPages : options.max;\n    counter = counter > doc.numPages ? doc.numPages : counter;\n\n    ret.text = \"\";\n\n    for (var i = 1; i <= counter; i++) {\n        let pageText = await doc.getPage(i).then(pageData => options.pagerender(pageData)).catch((err)=>{\n            // todo log err using debug\n            debugger;\n            return \"\";\n        });\n\n        ret.text = `${ret.text}\\n\\n${pageText}`;\n    }\n\n    ret.numrender = counter;\n    doc.destroy();\n\n    return ret;\n}\n\nmodule.exports = PDF;\n"]},"metadata":{},"sourceType":"script"}